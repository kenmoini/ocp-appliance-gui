#
# Note: This is a sample ApplianceConfig file showing
# which fields are available to aid you in creating your
# own appliance-config.yaml file.
#
apiVersion: v1beta1
kind: ApplianceConfig

ocpRelease:
  # OCP release version in major.minor or major.minor.patch format
  # (in case of major.minor, latest patch version will be used)
  # If the specified version is not yet available, the latest supported version will be used.
  # Supported versions: 4.14-4.19
  version: {{ ocpVersion | default('4.19') }}

  # OCP release update channel: stable|fast|eus|candidate
  # Default: stable
  # [Optional]
  channel: {{ ocpChannel | default('stable') }}

  # OCP release CPU architecture: x86_64|aarch64|ppc64le
  # Default: x86_64
  # [Optional]
  cpuArchitecture: {{ ocpArchitecture | default('x86_64') }}

  # OCP release URL (use instead of channel/architecture)
  # [Optional]
  # url: ocp-release-url

# Virtual size of the appliance disk image.
# If specified, should be at least 150GiB.
# If not specified, the disk image should be resized when 
# cloning to a device (e.g. using virt-resize tool).
# [Optional]
{% if diskSizeGB is defined %}
diskSizeGB: {{ diskSizeGB }}
{% endif %}

# PullSecret is required for mirroring the OCP release payload
# Can be obtained from: https://console.redhat.com/openshift/install/pull-secret
pullSecret: |
  {{ pullSecret }}

# Public SSH key for accessing the appliance during the bootstrap phase
# [Optional]
{%- if publicKey is defined and publicKey|length > 0 %}
sshKey: {{ publicKey }}
{%- else %}
# sshKey: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCy...
{%- endif %}

# Password of user 'core' for connecting from console
# [Optional]
{%- if coreUserPass is defined and coreUserPass|length > 0 %}
userCorePass: {{ coreUserPass }}
{%- else %}
# userCorePass: password
{%- endif %}

# Local image registry details (used when building the appliance)
# Note: building an image internally by default.
# [Optional]
# imageRegistry:
  # The URI for the image
  # Default: ""
  # Examples: 
  # - docker.io/library/registry:2
  # - quay.io/libpod/registry:2.8
  # [Optional]
  # uri: uri
  # The image registry container TCP port to bind. A valid port number is between 1024 and 65535.
  # Default: 5005
  # [Optional]
  # port: port

# Enable all default CatalogSources (on openshift-marketplace namespace).
# Should be disabled for disconnected environments.
# Default: false
# [Optional]
enableDefaultSources: {{ 'true' if enableDefaultSources else 'false' }}

# Stop the local registry post cluster installation.
# Note that additional images and operators won't be available when stopped.
# Default: false
# [Optional]
stopLocalRegistry: {{ 'true' if stopLocalRegistry else 'false' }}

# Create PinnedImageSets for both the master and worker MCPs.
# The PinnedImageSets will include all the images included in the appliance disk image.
# Requires openshift version 4.16 or above.
# WARNING: 
# As of 4.18, PinnedImageSets feature is still not GA.
# Thus, enabling it will set the cluster to tech preview,
# which means the cluster cannot be upgraded
# (i.e. should only be used for testing purposes).
# Default: false
# [Optional]
createPinnedImageSets: {{ 'true' if createPinnedImageSets else 'false' }}

# Enable FIPS mode for the cluster.
# Note: 'fips' should be enabled also in install-config.yaml.
# Default: false
# [Optional]
enableFips: {{ 'false' if fipsMode == "Disabled" else 'true' }}

# Enable the interactive installation flow.
# Should be enabled to provide cluster configuration through the web UI
# (i.e. instead of using a config-image).
# Default: false
# [Optional]
enableInteractiveFlow: {{ 'true' if enableInteractiveFlow else 'false' }}

# Rename CatalogSource names generated by oc-mirror to the default naming.
# E.g. 'redhat-operators' instead of 'cs-redhat-operator-index-v4-19'.
# Default: false
# [Optional]
useDefaultSourceNames: {{ 'true' if useDefaultSourceNames else 'false' }}

# Additional images to be included in the appliance disk image.
# [Optional]
{% if additionalImages is defined %}
{% if additionalImages | length > 0 %}
additionalImages:
{% for image in additionalImages %}
  - name: {{ image }}
{% endfor %}
{% endif %}
{% endif %}


# Operators to be included in the appliance disk image.
# See examples in https://github.com/openshift/oc-mirror/blob/main/docs/imageset-config-ref.yaml.
# [Optional]
#operators:
#- catalog: registry.redhat.io/redhat/redhat-operator-index:v4.19
#  packages:
#    - name: advanced-cluster-management
#    - name: ansible-automation-platform-operator
#    - name: cincinnati-operator
#    - name: devspaces
#    - name: devworkspace-operator
#    - name: rhods-operator
#    - name: local-storage-operator
#    - name: lvms-operator
#    - name: metallb-operator
#    - name: mtv-operator
#    - name: multicluster-engine
#    - name: ocs-client-operator
#    - name: odf-operator
#    - name: openshift-gitops-operator
#    - name: openshift-pipelines-operator-rh
#    - name: redhat-oadp-operator
#    - name: rhacs-operator
#    - name: kubevirt-hyperconverged
#    - name: nfd
#    - name: fence-agents-remediation
#    - name: node-maintenance-operator